<app-admin-header></app-admin-header>

<div class="flex flex-col gap-6 max-w-3xl mx-auto p-6">
  <!-- Profile Card -->
  <mat-card
    class="p-6 rounded-2xl shadow-md hover:shadow-lg transition bg-white"
  >
    <h2 class="text-xl font-semibold mb-6">Profile</h2>
    <form
      [formGroup]="profileForm"
      class="flex flex-col gap-6"
      (ngSubmit)="updateProfile()"
    >
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <mat-form-field appearance="fill">
          <mat-label>First Name</mat-label>
          <input
            matInput
            placeholder="First name"
            formControlName="firstName"
            required
          />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Last Name</mat-label>
          <input
            matInput
            placeholder="Last name"
            formControlName="lastName"
            required
          />
        </mat-form-field>
      </div>

      <div class="flex justify-end">
        <button
          mat-flat-button
          color="primary"
          type="submit"
          [disabled]="profileForm.invalid"
          class="rounded-lg"
        >
          <mat-icon>save</mat-icon>
          Save Changes
        </button>
      </div>
    </form>
  </mat-card>

  <!-- Email Card -->
  <mat-card
    class="p-6 rounded-2xl shadow-md hover:shadow-lg transition bg-white"
  >
    <h2 class="text-xl font-semibold mb-6">Email</h2>
    <form
      [formGroup]="emailForm"
      class="flex flex-col gap-6"
      (ngSubmit)="updateEmail()"
    >
      <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input
          matInput
          placeholder="Email address"
          formControlName="email"
          required
        />
      </mat-form-field>

      <div class="flex justify-end">
        <button
          mat-flat-button
          color="primary"
          type="submit"
          [disabled]="emailForm.invalid"
          class="rounded-lg"
        >
          <mat-icon>mail</mat-icon>
          Update Email
        </button>
      </div>
    </form>
  </mat-card>

  <!-- Password Card -->
  <mat-card
    class="p-6 rounded-2xl shadow-md hover:shadow-lg transition bg-white"
  >
    <h2 class="text-xl font-semibold mb-6">Password</h2>
    <form
      [formGroup]="passwordForm"
      class="flex flex-col gap-6"
      (ngSubmit)="updatePassword()"
    >
      <!-- Current Password -->
      <mat-form-field appearance="fill" class="w-full">
        <mat-label>Current Password</mat-label>
        <input
          matInput
          [type]="hideCurrentPassword ? 'password' : 'text'"
          formControlName="currentPassword"
          required
        />
        <button
          mat-icon-button
          matSuffix
          type="button"
          (click)="hideCurrentPassword = !hideCurrentPassword"
          [attr.aria-label]="'Hide or show current password'"
        >
          <mat-icon>{{
            hideCurrentPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
        </button>
      </mat-form-field>

      <!-- New Password + Confirm Password -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- New Password -->
        <mat-form-field appearance="fill">
          <mat-label>New Password</mat-label>
          <input
            matInput
            [type]="hideNewPassword ? 'password' : 'text'"
            formControlName="newPassword"
            required
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hideNewPassword = !hideNewPassword"
            [attr.aria-label]="'Hide or show new password'"
          >
            <mat-icon>{{
              hideNewPassword ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>

          <!-- Pattern error -->
          <mat-error
            *ngIf="passwordForm.get('newPassword')?.hasError('pattern')"
          >
            Password must contain at least 1 uppercase, 1 lowercase, 1 number,
            and 1 special character and be at least 8 characters long.
          </mat-error>
        </mat-form-field>

        <!-- Confirm New Password -->
        <!-- Confirm New Password -->
        <mat-form-field appearance="fill">
          <mat-label>Confirm New Password</mat-label>
          <input
            matInput
            [type]="hideConfirmPassword ? 'password' : 'text'"
            formControlName="confirmPassword"
            required
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="hideConfirmPassword = !hideConfirmPassword"
            [attr.aria-label]="'Hide or show confirm password'"
          >
            <mat-icon>{{
              hideConfirmPassword ? "visibility_off" : "visibility"
            }}</mat-icon>
          </button>

          <!-- Password mismatch error -->
          <mat-error
            *ngIf="
              passwordForm.hasError('passwordMismatch') &&
              passwordForm.get('confirmPassword')?.touched
            "
          >
            Passwords do not match.
          </mat-error>
        </mat-form-field>
      </div>

      <div class="flex justify-end">
        <button
          mat-flat-button
          color="primary"
          type="submit"
          [disabled]="passwordForm.invalid"
          class="rounded-lg"
        >
          Change Password
        </button>
      </div>
    </form>
  </mat-card>
</div>
